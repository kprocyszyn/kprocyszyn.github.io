<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Resolve IP and DNS with Powershell tool - Kamil Procyszyn</title><meta name="Description" content=""><meta property="og:title" content="Resolve IP and DNS with Powershell tool" />
<meta property="og:description" content="I’ve been asked to prepare a simple tool which would:
 Resolve IP address or DNS Return all results to table Import addresses from a file  The reason behind was to check how IP/DNS records change over the period of time, therefore there was a need for something like that:
 A file with all addresses in question Tool which could import all these addresses and resolve them Save the results into a new file  Once having at least a couple of files, the results could be compared." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://kprocyszyn.github.io/powershell-tool-resolve-ip-and-dns/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-04-29T21:40:00+00:00" />
<meta property="article:modified_time" content="2018-04-29T21:40:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Resolve IP and DNS with Powershell tool"/>
<meta name="twitter:description" content="I’ve been asked to prepare a simple tool which would:
 Resolve IP address or DNS Return all results to table Import addresses from a file  The reason behind was to check how IP/DNS records change over the period of time, therefore there was a need for something like that:
 A file with all addresses in question Tool which could import all these addresses and resolve them Save the results into a new file  Once having at least a couple of files, the results could be compared."/>
<meta name="application-name" content="Kamil Procyszyn">
<meta name="apple-mobile-web-app-title" content="Kamil Procyszyn"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://kprocyszyn.github.io/powershell-tool-resolve-ip-and-dns/" /><link rel="prev" href="http://kprocyszyn.github.io/ultimate-windows-update-fix/" /><link rel="next" href="http://kprocyszyn.github.io/use-windows-server-as-iscsi-target-with-esxi/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Resolve IP and DNS with Powershell tool",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/kprocyszyn.github.io\/powershell-tool-resolve-ip-and-dns\/"
        },"genre": "post","keywords": "dns, feat, ip, network, powershell, resolve, toolmaking","wordcount":  356 ,
        "url": "http:\/\/kprocyszyn.github.io\/powershell-tool-resolve-ip-and-dns\/","datePublished": "2018-04-29T21:40:00+00:00","dateModified": "2018-04-29T21:40:00+00:00","publisher": {
            "@type": "Organization",
            "name": "Kamil"},"author": {
                "@type": "Person",
                "name": "Kamil"
            },"description": ""
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Kamil Procyszyn">Kamil Procyszyn</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Kamil Procyszyn">Kamil Procyszyn</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="page single special"><h1 class="single-title animated pulse faster">Resolve IP and DNS with Powershell tool</h1><div class="content" id="content"><p>I’ve been asked to prepare a simple tool which would:</p>
<ul>
<li>Resolve IP address or DNS</li>
<li>Return all results to table</li>
<li>Import addresses from a file</li>
</ul>
<p>The reason behind was to check how IP/DNS records change over the period of time, therefore there was a need for something like that:</p>
<ul>
<li>A file with all addresses in question</li>
<li>Tool which could import all these addresses and resolve them</li>
<li>Save the results into a new file</li>
</ul>
<p>Once having at least a couple of files, the results could be compared.</p>
<p>There are tools like ping, nslookup or Powershell’s Resolve-DnsName but they simply can’t meet all the requiments (or at least not to my knowledge).  So I simply needed to prepare the dedicated tool.</p>
<p>And thus I’ve created Resolve-IPDNS, the source code at the moment of writing this post looks like this:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Let’s break down the function now:</p>
<!-- raw HTML omitted -->
<p>Since $IPDNS can take multiple values, I want to process the function for every address it is given.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>The code above prepares the parameters which are going to be parsed to Resolve-DnsName . It establishes if the value is the IP address or DNS name “(IF ($addrs -as [ipaddress])” and then specifies the appropiate query type (Either A record for DNS or PTR record for IP).</p>
<p>It’s not really necessary, but gives more control over function.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Now, the script prepares properties for the new custom object. Since Powershell uses different property names for different queries, it’s essential to expand the right ones. As you can see above, for the IP address the IP and DNS properties are called Name and NameHost respectively, while for DNS they’re called IPAddress and Name, respectively.</p>
<p>By creating properties that way, I’m able to create an object with two consistent collums: IP and DNS which you can see bellow:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>This is it, Powershell will output the nicely formated data onto your screen now:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>As you can see, it can even deal with round robing entries!</p>
<p>You can obviously pipe the data into the function and export it to e.g. csv.</p>
<p>You can always find up-to-date version of the tool here: <a href="https://github.com/kprocyszyn" target="_blank" rel="noopener noreffer">https://github.com/kprocyszyn</a></p>
<p>Main photo by: <a href="https://unsplash.com/photos/cYUMaCqMYvI?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener noreffer">Jungwoo Hong</a> on <a href="https://unsplash.com/search/photos/point-sign?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener noreffer">Unsplash</a></p>
</div></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.91.2">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
