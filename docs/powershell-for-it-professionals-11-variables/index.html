<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>PowerShell for IT Professionals [#11] – Variables - Kamil Procyszyn</title><meta name="Description" content=""><meta property="og:title" content="PowerShell for IT Professionals [#11] – Variables" />
<meta property="og:description" content="In this lesson we’re going to learn how what Variables are, why it’s good to use them and how to actually create them. We will then assign various values to variables to and use them solely, and in parameters.
We will also have a look at foreach loop so that we can e.g. ping multiple computers using single variable with multiple objects in it.
Exercises   Use Get-Command to find all commands that allow you to manage variables." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://kprocyszyn.github.io/powershell-for-it-professionals-11-variables/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-29T10:39:05+00:00" />
<meta property="article:modified_time" content="2020-08-29T10:39:05+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="PowerShell for IT Professionals [#11] – Variables"/>
<meta name="twitter:description" content="In this lesson we’re going to learn how what Variables are, why it’s good to use them and how to actually create them. We will then assign various values to variables to and use them solely, and in parameters.
We will also have a look at foreach loop so that we can e.g. ping multiple computers using single variable with multiple objects in it.
Exercises   Use Get-Command to find all commands that allow you to manage variables."/>
<meta name="application-name" content="Kamil Procyszyn">
<meta name="apple-mobile-web-app-title" content="Kamil Procyszyn"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://kprocyszyn.github.io/powershell-for-it-professionals-11-variables/" /><link rel="prev" href="http://kprocyszyn.github.io/powershell-for-it-professionals-10-remote-management-with-powershell/" /><link rel="next" href="http://kprocyszyn.github.io/powershell-for-it-professionals-12-wmi-windows-management-instrumentation/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "PowerShell for IT Professionals [#11] – Variables",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/kprocyszyn.github.io\/powershell-for-it-professionals-11-variables\/"
        },"genre": "post","keywords": "array, collection, course, foreach, IT, powershell, sysadmin, variable","wordcount":  371 ,
        "url": "http:\/\/kprocyszyn.github.io\/powershell-for-it-professionals-11-variables\/","datePublished": "2020-08-29T10:39:05+00:00","dateModified": "2020-08-29T10:39:05+00:00","publisher": {
            "@type": "Organization",
            "name": "Kamil"},"author": {
                "@type": "Person",
                "name": "Kamil"
            },"description": ""
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Kamil Procyszyn">Kamil Procyszyn</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Kamil Procyszyn">Kamil Procyszyn</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="page single special"><h1 class="single-title animated pulse faster">PowerShell for IT Professionals [#11] – Variables</h1><div class="content" id="content">
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/CfCySkaJDJ0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<p>In this lesson we’re going to learn how what Variables are, why it’s good to use them and how to actually create them. We will then assign various values to variables to and use them solely, and in parameters.</p>
<p>We will also have a look at foreach loop so that we can e.g. ping multiple computers using single variable with multiple objects in it.</p>
<h2 id="exercises">Exercises</h2>
<ul>
<li>
<p>Use Get-Command to find all commands that allow you to manage variables. Then find the command that let’s to display all currently available variables.</p>
</li>
<li>
<p>In notepad, store a few hostnames/ip addresses each in separate line</p>
<ul>
<li>Use Get-Content commandlet to read the content of the file just created</li>
<li>Store the content of the file into a variable</li>
<li>Display all the objects of variable – it should be exactly the same as content of the file</li>
<li>Use foreach loop to ping all the servers from your variable</li>
</ul>
</li>
</ul>
<h2 id="common-variable-types">Common variable types</h2>
<ul>
<li>[string] – Text string</li>
<li>[char] – a single character</li>
<li>[bool] – Boolean (can be either $True or $False)</li>
<li>[int] or [int32] – 32-bit Integer</li>
<li>[long] or [int64] – 64 – bit Integer</li>
<li>[DateTime] – Date and time</li>
</ul>
<h2 id="commands-used-in-the-lesson">Commands used in the lesson</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Let&#39;s work on simple string</span>
<span class="s2">&#34;Kamil Procyszyn&#34;</span> 

<span class="s2">&#34;Kamil Procyszyn&#34;</span> 
<span class="p">|</span> <span class="nb">GM
</span><span class="nb"></span>
<span class="nv">$name</span> <span class="p">=</span> <span class="s2">&#34;Kamil Procyszyn&#34;</span>

<span class="nv">$name</span><span class="p">|</span> <span class="nb">GM
</span><span class="nb"></span>
<span class="c"># Same with numbers</span>

<span class="n">3</span> 

<span class="n">3</span> <span class="p">|</span> <span class="nb">GM
</span><span class="nb"></span>
<span class="n">3</span> <span class="p">+</span> <span class="n">5</span>

<span class="nv">$a</span> <span class="p">=</span> <span class="n">3</span>

<span class="nv">$a</span> <span class="p">|</span> <span class="nb">GM
</span><span class="nb"></span>
<span class="nv">$b</span> <span class="p">=</span> <span class="n">5</span>

<span class="nv">$a</span> <span class="p">+</span> <span class="nv">$b</span>

<span class="c"># Let&#39;s check what will happen after changing the value of one of properties</span>

<span class="nv">$a</span> <span class="p">=</span> <span class="n">10</span>

<span class="nv">$a</span> <span class="p">+</span> <span class="nv">$b</span>

<span class="c"># Let&#39;s use variables with parameters</span>

<span class="nv">$server</span> <span class="p">=</span> <span class="s2">&#34;PS-SVR1&#34;</span>

<span class="nb">Test-NetConnection</span> <span class="nv">$server</span>

<span class="n">Ping</span> <span class="nv">$server</span>

<span class="nb">Get-Process</span> <span class="n">-ComputerName</span> <span class="nv">$server</span>

<span class="c"># Variables give access to methods</span>

<span class="nv">$name</span>

<span class="nv">$name</span> <span class="p">|</span> <span class="nb">GM
</span><span class="nb"></span>
<span class="nv">$name</span>

<span class="nv">$name</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">()</span>

<span class="nv">$name</span><span class="p">.</span><span class="n">ToLower</span><span class="p">()</span>

<span class="c"># We can store output of commands to variables and access their properties</span>

<span class="nv">$services</span> <span class="p">=</span> <span class="nb">Get-Service</span>

<span class="nv">$services</span>

<span class="nv">$services</span><span class="p">.</span><span class="n">name</span>

<span class="c"># We can obviously pipe</span>

<span class="nv">$services</span> <span class="p">|</span> <span class="nb">where </span><span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">status</span> <span class="o">-like</span> <span class="s1">&#39;s*&#39;</span><span class="p">}</span>

<span class="c"># Storing multiple objects in variable</span>

<span class="nv">$computers</span> <span class="p">=</span> <span class="s1">&#39;ps-svr1&#39;</span><span class="p">,</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span><span class="s1">&#39;1.1.1.1&#39;</span><span class="p">,</span><span class="s1">&#39;8.8.8.8&#39;</span><span class="p">,</span><span class="s1">&#39;kamilpro.com&#39;</span>

<span class="nv">$computers</span>

<span class="nv">$computers</span><span class="p">&amp;</span><span class="c">#91;0]</span>

<span class="nv">$computers</span><span class="p">&amp;</span><span class="c">#91;2]</span>

<span class="nv">$computers</span><span class="p">&amp;</span><span class="c">#91;-1]</span>

<span class="c"># Let&#39;s try to ping all of them</span>

<span class="n">ping</span> <span class="nv">$computers</span>

<span class="nb">Test-NetConnection</span> <span class="nv">$computers</span>

<span class="c"># If command doesn&#39;t allow to provide an array, we can loop through it</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$c</span> <span class="k">in</span> <span class="nv">$computers</span><span class="p">)</span> <span class="p">{</span><span class="n">ping</span> <span class="nv">$c</span><span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$c</span> <span class="k">in</span> <span class="nv">$computers</span><span class="p">)</span> <span class="p">{</span><span class="nb">Test-NetConnection</span> <span class="nv">$c</span><span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$c</span> <span class="k">in</span> <span class="nv">$computers</span><span class="p">)</span> <span class="p">{</span><span class="n">nslookup</span> <span class="nv">$c</span><span class="p">}</span>
</code></pre></div></div></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.91.2">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
