<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Deploying software with GPO - Kamil Procyszyn</title><meta name="Description" content=""><meta property="og:title" content="Deploying software with GPO" />
<meta property="og:description" content="Having software consistently deployed across the fleet of computers is one of the key points that can be automated.
If I have a choice (and it makes sense), I will always choose GPO over any other solution because it’s embedded into Active Directory thus not requiring installation, learning and maintenance of additional management tool.
MSI – Software Installation One of the main advantages of MSI installers is that in 99% of cases you can just use the “Software Installation” option in GPO, and GPO will take care of the silent installation." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://kprocyszyn.github.io/deploying-software-with-gpo/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-15T14:25:59+00:00" />
<meta property="article:modified_time" content="2020-03-15T14:25:59+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Deploying software with GPO"/>
<meta name="twitter:description" content="Having software consistently deployed across the fleet of computers is one of the key points that can be automated.
If I have a choice (and it makes sense), I will always choose GPO over any other solution because it’s embedded into Active Directory thus not requiring installation, learning and maintenance of additional management tool.
MSI – Software Installation One of the main advantages of MSI installers is that in 99% of cases you can just use the “Software Installation” option in GPO, and GPO will take care of the silent installation."/>
<meta name="application-name" content="Kamil Procyszyn">
<meta name="apple-mobile-web-app-title" content="Kamil Procyszyn"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://kprocyszyn.github.io/deploying-software-with-gpo/" /><link rel="prev" href="http://kprocyszyn.github.io/prepare-hyper-v-template-of-windows-server-2016-2019/" /><link rel="next" href="http://kprocyszyn.github.io/powershell-for-it-professionals-1-help/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Deploying software with GPO",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/kprocyszyn.github.io\/deploying-software-with-gpo\/"
        },"genre": "post","keywords": "active directory, deployment, gpo, software","wordcount":  896 ,
        "url": "http:\/\/kprocyszyn.github.io\/deploying-software-with-gpo\/","datePublished": "2020-03-15T14:25:59+00:00","dateModified": "2020-03-15T14:25:59+00:00","publisher": {
            "@type": "Organization",
            "name": "Kamil"},"author": {
                "@type": "Person",
                "name": "Kamil"
            },"description": ""
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Kamil Procyszyn">Kamil Procyszyn</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Kamil Procyszyn">Kamil Procyszyn</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="page single special"><h1 class="single-title animated pulse faster">Deploying software with GPO</h1><div class="content" id="content"><p>Having software consistently deployed across the fleet of computers is one of the key points that can be automated.</p>
<p>If I have a choice (and it makes sense), I will always choose GPO over any other solution because it’s embedded into Active Directory thus not requiring installation, learning and maintenance of additional management tool.</p>
<h1 id="msi-8211-software-installation">MSI – Software Installation</h1>
<p>One of the main advantages of MSI installers is that in 99% of cases you can just use the “Software Installation” option in GPO, and GPO will take care of the silent installation. In addition, if the newer version of the installer is ever listed, you can simply link the newer version of the installer, and GPO will take care of upgrading current installations.</p>
<p>The rule is, if the installer doesn’t have any mandatory custom made parameters, it will silently push the software.</p>
<h2 id="how-to-find-out-if-the-msi-can-be-silently-installed-with-gpo">How to find out if the MSI can be silently installed with GPO</h2>
<p>We are going to use the MsiExec (Windows Installer) tool, my installer file is called: GoogleChromeStandaloneEnterprise64.msi</p>
<p>And command line syntax is:</p>
<!-- raw HTML omitted -->
<p>Thus making my command to look like this:</p>
<!-- raw HTML omitted -->
<p>If after issuing that command you can see your piece of software has been installed, it’s good to go with GPO.</p>
<h2 id="set-up-gpo">Set up GPO</h2>
<p>To make the GPO working, we need to put an installer file on some network share, and since it’s going to be computers accessing the file, the computer must have read access – not the user – to the file. The easiest way to achieve this is to use NETLOGON folder.</p>
<p>You access it via <a href="file://DomainNAme/NETLOGON" target="_blank" rel="noopener noreffer">\&laquo;DomainNAme&raquo;\NETLOGON</a></p>
<p>If you’re not sure what your domain name is, simply open Group Policy manager and it will be listed there:<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --> <!-- raw HTML omitted --></p>
<p>So I’m going to copy the installer file to my NETLOGON folder:</p>
<p><a href="file://company.pri/NETLOGON" target="_blank" rel="noopener noreffer">\company.pri\NETLOGON</a></p>
<p>And create a new GPO:<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --> <!-- raw HTML omitted --></p>
<p>To create a GPO for the installer:</p>
<p>After opening the Group Policy Management, right-click on the root/or OU and choose to create a new GPO and link it.</p>
<p>Give it an appropriate name and then expand settings:</p>
<p>Computer &gt; Policies &gt; Software Settings &gt; Software Installation. Then right-click &gt; New &gt; Package.</p>
<p>Point it to your installer file – critical is you must point via network share; thus either <a href="file://DomainName/someshare%20or%20/ComputerName/share" target="_blank" rel="noopener noreffer">\DomainName\someshare or \ComputerName\share</a> </p>
<p>Choose assign and job done.</p>
<h1 id="exe-and-non-standard-msi-files">EXE and Non-standard MSI files</h1>
<p>Sometimes the software installer requires providing custom switches, and the only way to achieve the installation is to use a custom script. Thankfully in GPO, we have an option of startup/shutdown scripts – that the script will execute every time the computers boots/shuts down.</p>
<!-- raw HTML omitted -->
<p>The problem with that kind of installers is the fact they often don’t advertise what switches are required, making it much more difficult. Thus at this stage, you might be forced to either check the developer’s website/manual or even contact them if the silent installation is supported. You can also have a look in the section of tips below which might point you to the solution.</p>
<p>Let’s take as an example the installer for Airtame – it’s MSI based, however, requires special switches for silent installation. Likely enough, the software vendor has provided the manual and switches required:</p>
<p><a href="https://help.airtame.com/en/articles/2543555-how-to-deploy-the-airtame-app-via-msi" target="_blank" rel="noopener noreffer">https://help.airtame.com/en/articles/2543555-how-to-deploy-the-airtame-app-via-msi</a></p>
<p>The fastest way to validate the script, without writing the script, is to run in the shell.</p>
<p>You can open the shell by pressing and holding SHIFT key, then right-click in the windows and choose “Open Windows shell here”</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Once I’ve validated it’s been installed, time to create a script.</p>
<h2 id="gpo-with-the-startup-scriptfigure-classwp-block-image-size-large">GPO with the Startup script<!-- raw HTML omitted --></h2>
<p><!-- raw HTML omitted --> <!-- raw HTML omitted --></p>
<p>I’ve put the installer to the NETLOGON as a previous installer.</p>
<p>Create a new GPO and configure it as follows:</p>
<p>Expand Computer Configuration &gt; Policies &gt; Windows Settings &gt; Scripts &gt; Startup</p>
<p>In the Startup Properties click “Show Files…” and create a new text file there, changing its extension to BAT (what I have set up on all my machines, is to show file extensions – this way I can change file extensions as a file name change), open it and paste the script below:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>First-line changes to the working directory to the folder where installation file is</p>
<p>The second line is the same command with testes moment ago</p>
<p>The last line will return the path the original location – not really needed, but it’s nice to have it.</p>
<p>Save the file.</p>
<p>Before closing the Startup explorer window, copy the path (it’s ridiculously long) in my example:</p>
<p><a href="file://company.pri/SysVol/company.pri/Policies/%7b299CE059-AD3B-4F12-9DC3-3AC9EB36124E%7d/Machine/Scripts/Startup" target="_blank" rel="noopener noreffer">\company.pri\SysVol\company.pri\Policies{299CE059-AD3B-4F12-9DC3-3AC9EB36124E}\Machine\Scripts\Startup</a></p>
<p>Coming back to “Startup Properties” window, click “Add” this time, and if you can’t see your script, paste the path to the window – now you can point to the script file you’ve just created.</p>
<p>Go to your test machine, run “gpupdate /force” from the shell and reboot your machine – validate the software got installed.</p>
<h1 id="helpful-websites">Helpful websites</h1>
<p><a href="https://chocolatey.org/search" target="_blank" rel="noopener noreffer">https://chocolatey.org/search</a> – Chocolatey is a powerful package manager based on PowerShell. You can discover switches by reviewing their ps1 files, available on the website. It’s also a great product for installing and maintaining your application – have a look and you’ll forget what it’s like to Google for software installer and updating applications one by one.</p>
<p><a href="https://www.manageengine.com/products/desktop-central/software-installation/latest-software.html" target="_blank" rel="noopener noreffer">https://www.manageengine.com/products/desktop-central/software-installation/latest-software.html</a> – Another great tool, this one is being used for managing computers. On the link above, you can discover how they push particular pieces of software.</p>
<p><a href="https://www.itninja.com/" target="_blank" rel="noopener noreffer">https://www.itninja.com/</a> – a great website for IT Professionals, and in context of this post, has a lot of how-tos on deploying software.</p>
<!-- raw HTML omitted -->
<p>Photo by <a href="https://unsplash.com/@fellowferdi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener noreffer">Ferdinand Stöhr</a> on <a href="https://unsplash.com/s/photos/pattern?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener noreffer">Unsplash</a></p>
</div></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.91.2">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
